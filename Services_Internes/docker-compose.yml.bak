version: "3.3"

services:
    soa-interne:
        build:
            context: 
                ./SOA_INTERNE
            dockerfile: 
                dockerfile
        networks:
            local_network:
                ipv4_address: 192.168.1.1    
        volumes:
            - ./SOA_INTERNE/named.conf:/etc/bind/named.conf
 
        container_name:
            soa-interne
            
    resolveur-interne:
        build:
            context: 
                ./RESOLVEUR_INTERNE
            dockerfile:
                dockerfile
        ports:
            - "53:53/tcp"
            - "53:53/udp"
        networks:
            local_network:
                ipv4_address: 192.168.1.3
        volumes:
            - ./RESOLVEUR_INTERNE/named.conf:/etc/bind/named.conf
        container_name:
            resolveur-interne
    partage-samba:
        build:
            context:
                ./SMB
            dockerfile:
                dockerfile
        ports:
            - "139:139"
            - "445:445"
        networks:
            local_network:
                ipv4_address: 192.168.1.4
        container_name:
            partage-samba
    atelier:
        build:
            context:
                ./POSTE
            dockerfile:
                Dockerfile
        networks: 
            atelier_network:
                ipv4_address: 192.168.4.1
        container_name:
            poste-atelier
            
    secretariat:
        build:
            context:
                ./POSTE
            dockerfile:
                Dockerfile
        networks: 
            secretariat_network:
                ipv4_address: 192.168.5.2
        container_name:
            poste-secretariat
                
    direction:
        build:
            context:
                ./POSTE
            dockerfile:
                Dockerfile
        networks: 
            direction_network:
                ipv4_address: 192.168.5.1
        container_name:
            poste-secretariat
            
    commerciaux:
        build:
            context:
                ./POSTE
            dockerfile:
                Dockerfile
        networks: 
            commerciaux_network:
                ipv4_address: 192.168.3.1
        container_name:
            poste-commerciaux
            
    compta:
        build:
            context:
                ./POSTE
            dockerfile:
                Dockerfile
        networks: 
            compta_network:
                ipv4_address: 192.168.2.1
        container_name:
            poste-compta
            
networks:
  local_network:
    ipam:
      driver: default
      config:
        - subnet: 192.168.0.0/24
        gateway: 192.168.0.253
  direction_network:
    ipam:
      driver: default
      config:
        - subnet: 192.168.5.0/24
        gateway: 192.168.5.253
  atelier_network:
    ipam:
      driver: default
      config:
        - subnet: 192.168.1.0/24
        gateway: 192.168.1.253
  compta_network:
    ipam:
      driver: default
      config:
        - subnet: 192.168.2.0/24
        gateway: 192.168.2.253
  commerciaux_network:
    ipam:
      driver: default
      config:
        - subnet: 192.168.3.0/24
        gateway: 192.168.3.253
  secretariat_network:
    ipam:
      driver: default
      config:
        - subnet: 192.168.4.0/24
        gateway: 192.168.4.253